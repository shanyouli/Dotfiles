#!/usr/bin/env bash
#
im_is_run() {
    local im
    if [[ -n $GTK_IM_MODULE ]]; then
        im=$GTK_IM_MODULE
    else
        im=fcitx5
    fi
    pgrep -x $im >/dev/null || {
        $im >/dev/null & disown && sleep 1 ;
    }
}
im_is_run

if command -v dbus-launch >/dev/null && pgrep -x dbus-daemon >/dev/null
then
    dbus-launch emacs $@
else
    LC_CTYPE="zh_CN.UTF-8" emacs $@
fi
